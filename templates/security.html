{% extends "base_beautiful.html" %}

{% block title %}Security Dashboard - HomeNetMon{% endblock %}

{% block head %}
{{ super() }}
<meta name="csrf-token" content="{{ csrf_token() }}">
{% endblock %}

{% block extra_css %}
<style>
    /* Security Dashboard Dark Theme */
    .security-cards-mobile {
        display: flex;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }

    .mobile-card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 20px;
        text-align: center;
        min-width: 120px;
        flex: 1;
        transition: all 0.3s ease;
    }

    .mobile-card:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .mobile-card-icon {
        font-size: 2rem;
        margin-bottom: 10px;
    }

    .mobile-card-value {
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .mobile-card-label {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.8);
    }

    .security-cards-desktop .card {
        background: rgba(255, 255, 255, 0.1) !important;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 15px;
        transition: all 0.3s ease;
    }

    .security-cards-desktop .card:hover {
        background: rgba(255, 255, 255, 0.15) !important;
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .card {
        background: rgba(255, 255, 255, 0.1) !important;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 15px;
        color: #fff;
    }

    .card-header {
        background: rgba(255, 255, 255, 0.1) !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 15px 15px 0 0 !important;
        color: #fff;
    }

    .card-body {
        color: #fff;
    }

    .bg-success {
        background: linear-gradient(135deg, rgba(40, 167, 69, 0.8), rgba(25, 135, 84, 0.8)) !important;
    }

    .bg-info {
        background: linear-gradient(135deg, rgba(13, 202, 240, 0.8), rgba(13, 110, 253, 0.8)) !important;
    }

    .bg-warning {
        background: linear-gradient(135deg, rgba(255, 193, 7, 0.8), rgba(255, 143, 0, 0.8)) !important;
    }

    .bg-danger {
        background: linear-gradient(135deg, rgba(220, 53, 69, 0.8), rgba(214, 51, 132, 0.8)) !important;
    }

    .bg-light {
        background: rgba(255, 255, 255, 0.1) !important;
        color: #fff !important;
    }

    .text-muted {
        color: rgba(255, 255, 255, 0.7) !important;
    }

    .border {
        border-color: rgba(255, 255, 255, 0.2) !important;
    }

    .progress {
        background: rgba(255, 255, 255, 0.2);
    }

    .table {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        color: #fff;
    }

    .table th {
        background: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.2);
        color: #fff;
    }

    .table td {
        border-color: rgba(255, 255, 255, 0.1);
        color: #fff;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background: rgba(255, 255, 255, 0.05);
    }

    .table-hover tbody tr:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    .badge {
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .alert {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
    }

    .alert-info {
        background: rgba(13, 202, 240, 0.2);
        border-color: rgba(13, 202, 240, 0.5);
    }

    .alert-warning {
        background: rgba(255, 193, 7, 0.2);
        border-color: rgba(255, 193, 7, 0.5);
    }

    .alert-danger {
        background: rgba(220, 53, 69, 0.2);
        border-color: rgba(220, 53, 69, 0.5);
    }

    .alert-success {
        background: rgba(25, 135, 84, 0.2);
        border-color: rgba(25, 135, 84, 0.5);
    }

    .btn-outline-primary {
        border-color: rgba(13, 110, 253, 0.8);
        color: #0d6efd;
        backdrop-filter: blur(5px);
    }

    .btn-outline-primary:hover {
        background: rgba(13, 110, 253, 0.2);
        border-color: #0d6efd;
        color: #fff;
    }

    .btn-outline-warning {
        border-color: rgba(255, 193, 7, 0.8);
        color: #ffc107;
        backdrop-filter: blur(5px);
    }

    .btn-outline-warning:hover {
        background: rgba(255, 193, 7, 0.2);
        border-color: #ffc107;
        color: #fff;
    }

    .btn-outline-secondary {
        border-color: rgba(108, 117, 125, 0.8);
        color: #6c757d;
        backdrop-filter: blur(5px);
    }

    .btn-outline-secondary:hover {
        background: rgba(108, 117, 125, 0.2);
        border-color: #6c757d;
        color: #fff;
    }

    .modal-content {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        color: #fff;
    }

    .modal-header {
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .modal-footer {
        border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    .spinner-border {
        border-color: rgba(13, 110, 253, 0.3);
        border-top-color: #0d6efd;
    }

    .bg-info.bg-opacity-10 {
        background: rgba(13, 202, 240, 0.1) !important;
    }

    .rounded {
        border-radius: 10px !important;
    }

    .text-info {
        color: #0dcaf0 !important;
    }

    .nav-tabs .nav-link {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(5px);
    }

    .nav-tabs .nav-link.active {
        background: rgba(13, 110, 253, 0.3);
        border-color: rgba(13, 110, 253, 0.5);
        color: #fff;
    }

    .tab-content {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        border-radius: 0 15px 15px 15px;
        padding: 20px;
    }

    .placeholder {
        background: rgba(255, 255, 255, 0.2);
    }

    .form-control {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
    }

    .form-control:focus {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(13, 110, 253, 0.8);
        color: #fff;
        box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }

    .form-select {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
    }

    .list-group-item {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
    }

    .list-group-item:hover {
        background: rgba(255, 255, 255, 0.15);
    }

    /* Priority indicator styles */
    .priority-indicator {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
        cursor: pointer;
        transition: transform 0.2s ease;
    }

    .priority-indicator:hover {
        transform: scale(1.1);
    }

    .priority-critical {
        background: linear-gradient(135deg, #dc3545, #c82333);
        color: white;
        border: 2px solid #dc3545;
        box-shadow: 0 2px 4px rgba(220, 53, 69, 0.3);
    }

    .priority-high {
        background: linear-gradient(135deg, #fd7e14, #e8590c);
        color: white;
        border: 2px solid #fd7e14;
        box-shadow: 0 2px 4px rgba(253, 126, 20, 0.3);
    }

    .priority-medium {
        background: linear-gradient(135deg, #ffc107, #e0a800);
        color: #000;
        border: 2px solid #ffc107;
        box-shadow: 0 2px 4px rgba(255, 193, 7, 0.3);
    }

    .priority-low {
        background: linear-gradient(135deg, #17a2b8, #117a8b);
        color: white;
        border: 2px solid #17a2b8;
        box-shadow: 0 2px 4px rgba(23, 162, 184, 0.3);
    }

    /* Risk Level Indicators */
    .risk-indicator {
        display: inline-flex;
        align-items: center;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .risk-indicator.risk-low {
        background: linear-gradient(135deg, #d4edda, #c3e6cb);
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .risk-indicator.risk-medium {
        background: linear-gradient(135deg, #fff3cd, #ffeeba);
        color: #856404;
        border: 1px solid #ffeeba;
    }

    .risk-indicator.risk-high {
        background: linear-gradient(135deg, #f8d7da, #f1b0b7);
        color: #721c24;
        border: 1px solid #f1b0b7;
    }

    .risk-indicator.risk-critical {
        background: linear-gradient(135deg, #721c24, #491217);
        color: white;
        border: 1px solid #721c24;
        box-shadow: 0 2px 4px rgba(114, 28, 36, 0.3);
    }

    /* Priority indicator styles */
    .priority-indicator {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
        cursor: pointer;
        transition: transform 0.2s ease;
    }

    .priority-indicator:hover {
        transform: scale(1.1);
    }

    .priority-critical {
        background: linear-gradient(135deg, #dc3545, #c82333);
        color: white;
        border: 2px solid #dc3545;
        box-shadow: 0 2px 4px rgba(220, 53, 69, 0.3);
    }

    .priority-high {
        background: linear-gradient(135deg, #fd7e14, #e8590c);
        color: white;
        border: 2px solid #fd7e14;
        box-shadow: 0 2px 4px rgba(253, 126, 20, 0.3);
    }

    .priority-medium {
        background: linear-gradient(135deg, #ffc107, #e0a800);
        color: #000;
        border: 2px solid #ffc107;
        box-shadow: 0 2px 4px rgba(255, 193, 7, 0.3);
    }

    .priority-low {
        background: linear-gradient(135deg, #17a2b8, #117a8b);
        color: white;
        border: 2px solid #17a2b8;
        box-shadow: 0 2px 4px rgba(23, 162, 184, 0.3);
    }

    /* Enhanced card styling */
    .card {
        transition: box-shadow 0.3s ease, border 0.3s ease;
    }

    .card:hover {
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }

    /* Risk Level Indicators */
    .risk-indicator {
        display: inline-flex;
        align-items: center;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .risk-indicator.risk-low {
        background: linear-gradient(135deg, #d4edda, #c3e6cb);
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .risk-indicator.risk-medium {
        background: linear-gradient(135deg, #fff3cd, #ffeeba);
        color: #856404;
        border: 1px solid #ffeeba;
    }

    .risk-indicator.risk-high {
        background: linear-gradient(135deg, #f8d7da, #f1b0b7);
        color: #721c24;
        border: 1px solid #f1b0b7;
    }

    .risk-indicator.risk-critical {
        background: linear-gradient(135deg, #721c24, #491217);
        color: white;
        border: 1px solid #721c24;
        box-shadow: 0 2px 4px rgba(114, 28, 36, 0.3);
    }

    /* Risk Score Visualization */
    .risk-score-display {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .risk-score-bar {
        width: 60px;
        height: 8px;
        background: #e9ecef;
        border-radius: 4px;
        overflow: hidden;
    }

    .risk-score-fill {
        height: 100%;
        transition: width 0.5s ease;
        border-radius: 4px;
    }

    /* Network Overview Enhancements */
    .device-security-badge {
        position: relative;
        display: inline-flex;
        align-items: center;
        padding: 2px 6px;
        border-radius: 8px;
        font-size: 0.7rem;
        font-weight: 500;
        text-transform: uppercase;
    }

    .device-security-badge::before {
        content: '';
        width: 6px;
        height: 6px;
        border-radius: 50%;
        margin-right: 4px;
    }

    .device-security-badge.secure::before {
        background: #28a745;
    }

    .device-security-badge.low-risk::before {
        background: #17a2b8;
    }

    .device-security-badge.medium-risk::before {
        background: #ffc107;
    }

    .device-security-badge.high-risk::before {
        background: #fd7e14;
    }

    .device-security-badge.critical-risk::before {
        background: #dc3545;
        box-shadow: 0 0 8px rgba(220, 53, 69, 0.5);
    }

    /* Alert details styling */
    .alert-details {
        max-width: 200px;
    }

    .impact-assessment {
        min-width: 120px;
    }

    .time-info {
        min-width: 80px;
    }

    /* Mobile-First Responsive Design */

    /* Mobile Summary Cards */
    @media (max-width: 991px) {
        .security-cards-mobile {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .security-cards-desktop {
            display: none;
        }

        .mobile-card {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }

        .mobile-card-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .mobile-card-value {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .mobile-card-label {
            font-size: 0.75rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
    }

    @media (min-width: 992px) {
        .security-cards-mobile {
            display: none;
        }

        .security-cards-desktop {
            display: flex;
        }
    }

    /* Mobile Alert Filters */
    @media (max-width: 768px) {
        .alert-filters .row {
            flex-direction: column;
            gap: 0.5rem;
        }

        .alert-filters .col-md-3 {
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .btn-group {
            flex-direction: column;
            width: 100%;
        }

        .btn-group .btn {
            border-radius: 0.375rem !important;
            margin-bottom: 0.25rem;
        }
    }

    /* Mobile Table Improvements */
    @media (max-width: 768px) {
        .table-responsive {
            font-size: 0.8rem;
        }

        /* Stack table cells vertically on mobile */
        .mobile-alert-card {
            display: block;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            background: white;
        }

        .mobile-alert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e9ecef;
        }

        .mobile-alert-body {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .mobile-alert-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
        }

        .mobile-alert-label {
            font-weight: 600;
            color: #495057;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mobile-alert-value {
            text-align: right;
            flex: 1;
            margin-left: 1rem;
        }

        .priority-indicator {
            width: 24px;
            height: 24px;
            font-size: 0.75rem;
        }

        .alert-details {
            max-width: none;
        }

        .btn-group-vertical .btn {
            font-size: 0.75rem;
            padding: 0.375rem 0.75rem;
            margin-bottom: 0.25rem;
        }

        /* Hide desktop table on mobile */
        .desktop-table {
            display: none;
        }
    }

    @media (min-width: 769px) {
        .mobile-alerts-view {
            display: none;
        }
    }

    /* Mobile Network Overview */
    @media (max-width: 768px) {
        .network-device-card {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            background: white;
        }

        .device-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .device-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .device-stat {
            text-align: center;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .device-stat-value {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .device-stat-label {
            font-size: 0.75rem;
            color: #6c757d;
        }
    }

    /* Touch-friendly interactions */
    @media (max-width: 768px) {
        .btn {
            min-height: 44px;
            padding: 0.75rem 1rem;
        }

        .btn-sm {
            min-height: 36px;
            padding: 0.5rem 0.75rem;
        }

        .form-control, .form-select {
            min-height: 44px;
            font-size: 1rem;
        }

        .form-check-input {
            width: 1.25rem;
            height: 1.25rem;
        }

        /* Larger tap targets for tooltips */
        [data-bs-toggle="tooltip"] {
            min-width: 44px;
            min-height: 44px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
    }

    /* Mobile Charts */
    @media (max-width: 768px) {
        .chart-container {
            height: 200px;
            margin-bottom: 1rem;
        }

        .row .col-lg-6 {
            margin-bottom: 1rem;
        }
    }

    /* Mobile Progress Indicators */
    @media (max-width: 768px) {
        #scan-stats {
            flex-direction: column;
            gap: 0.5rem;
        }

        #scan-stats .col-3 {
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .scan-stat-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }
    }

    /* Responsive text scaling */
    @media (max-width: 576px) {
        .h1, h1 {
            font-size: 1.5rem;
        }

        .h4, h4 {
            font-size: 1.1rem;
        }

        .card-title {
            font-size: 0.9rem;
        }
    }

    /* Scan progress enhancements */
    .progress {
        box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    /* Tooltip improvements */
    .tooltip {
        font-size: 0.875rem;
    }

    .tooltip .tooltip-inner {
        max-width: 300px;
        text-align: left;
        padding: 8px 12px;
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div class="d-flex align-items-center">
        <h1><i class="bi bi-shield-check"></i> Security Dashboard</h1>
        <span class="ms-3 text-muted" data-bs-toggle="tooltip" data-bs-placement="bottom" 
              data-bs-title="Monitor your network for security vulnerabilities, open ports, and suspicious activity. Regular scanning helps identify potential security risks.">
            <i class="bi bi-info-circle"></i>
        </span>
    </div>
    <div class="btn-group" role="group">
        <button type="button" class="btn btn-outline-primary" id="refresh-security-data"
                data-bs-toggle="tooltip" data-bs-placement="bottom" 
                data-bs-title="Update all security data with the latest scan results and alert information">
            <i class="bi bi-arrow-clockwise"></i> Refresh
        </button>
        <button type="button" class="btn btn-outline-warning" id="run-security-scan"
                data-bs-toggle="tooltip" data-bs-placement="bottom"
                data-bs-title="Start a comprehensive network scan to check all devices for open ports, services, and potential security risks">
            <i class="bi bi-search"></i> Run Network Scan
        </button>
        <button type="button" class="btn btn-outline-danger" id="stop-security-scan" disabled
                data-bs-toggle="tooltip" data-bs-placement="bottom"
                data-bs-title="Stop the currently running security scan (available when scan is active)">
            <i class="bi bi-stop-circle"></i> Stop Scan
        </button>
    </div>
</div>

<!-- Enhanced Security Scan Progress -->
<div class="row mb-3" id="scan-progress-container" style="display: none;">
    <div class="col-12">
        <div class="card border-primary" id="scan-progress-card">
            <div class="card-header bg-light">
                <div class="d-flex align-items-center justify-content-between">
                    <div class="d-flex align-items-center">
                        <div class="spinner-border spinner-border-sm text-primary me-2" role="status" id="scan-spinner">
                            <span class="visually-hidden">Scanning...</span>
                        </div>
                        <h6 class="mb-0 fw-bold">Network Security Scan</h6>
                        <span class="ms-3 badge bg-primary" id="scan-stage">Initializing</span>
                    </div>
                    <div class="text-end">
                        <small class="text-muted" id="scan-timer">0s</small>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <!-- Overall Progress -->
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span class="fw-medium" id="scan-status-text">Preparing scan...</span>
                        <span class="text-muted small" id="scan-percentage">0%</span>
                    </div>
                    <div class="progress mb-2" style="height: 12px;">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" 
                             role="progressbar" id="scan-progress-bar" style="width: 0%"></div>
                    </div>
                    <small class="text-muted" id="scan-details">Initializing network security scan...</small>
                </div>
                
                <!-- Scan Statistics -->
                <div class="row text-center" id="scan-stats" style="display: none;">
                    <div class="col-3">
                        <div class="border rounded p-2">
                            <div class="h5 mb-1 text-primary" id="devices-progress">0/0</div>
                            <small class="text-muted">Devices</small>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="border rounded p-2">
                            <div class="h5 mb-1 text-info" id="ports-scanned">0</div>
                            <small class="text-muted">Ports Checked</small>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="border rounded p-2">
                            <div class="h5 mb-1 text-warning" id="open-ports-found">0</div>
                            <small class="text-muted">Open Ports</small>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="border rounded p-2">
                            <div class="h5 mb-1 text-danger" id="alerts-generated">0</div>
                            <small class="text-muted">Security Alerts</small>
                        </div>
                    </div>
                </div>
                
                <!-- Current Device Info -->
                <div id="current-device-info" class="mt-3 p-2 bg-light rounded" style="display: none;">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-router text-primary me-2"></i>
                        <div>
                            <div class="fw-medium">Currently Scanning: <span id="current-device-name">--</span></div>
                            <small class="text-muted">Checking for open ports and services...</small>
                        </div>
                    </div>
                    <div class="progress mt-2" style="height: 6px;">
                        <div class="progress-bar bg-primary" id="current-device-progress" style="width: 0%"></div>
                    </div>
                </div>
                
                <!-- Scan Process Explanation -->
                <div class="mt-3 p-3 bg-info bg-opacity-10 rounded" id="scan-explanation">
                    <div class="d-flex align-items-start">
                        <i class="bi bi-info-circle text-info me-2 mt-1"></i>
                        <div>
                            <div class="fw-medium text-info mb-1">What's happening?</div>
                            <small class="text-muted" id="scan-explanation-text">
                                The security scanner is checking each device on your network for open ports and running services. 
                                This helps identify potential security vulnerabilities and unusual network activity.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Mobile Security Summary -->
<div class="security-cards-mobile d-lg-none">
    <div class="mobile-card" id="mobile-security-status">
        <div class="mobile-card-icon text-success">
            <i class="bi bi-shield-check"></i>
        </div>
        <div class="mobile-card-value text-success">Secure</div>
        <div class="mobile-card-label">Security Status</div>
    </div>
    <div class="mobile-card">
        <div class="mobile-card-icon text-info">
            <i class="bi bi-router"></i>
        </div>
        <div class="mobile-card-value" id="mobile-devices-scanned">--</div>
        <div class="mobile-card-label">Devices Scanned</div>
    </div>
    <div class="mobile-card">
        <div class="mobile-card-icon text-warning">
            <i class="bi bi-exclamation-triangle"></i>
        </div>
        <div class="mobile-card-value" id="mobile-total-alerts">--</div>
        <div class="mobile-card-label">Security Alerts</div>
    </div>
    <div class="mobile-card">
        <div class="mobile-card-icon text-danger">
            <i class="bi bi-shield-exclamation"></i>
        </div>
        <div class="mobile-card-value" id="mobile-high-risk">--</div>
        <div class="mobile-card-label">High Risk</div>
    </div>
</div>

<!-- Desktop Security Status Cards -->
<div class="row mb-4 security-cards-desktop">
    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title d-flex align-items-center">
                            Security Status 
                            <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                               data-bs-title="Overall network security health based on recent scans and alerts. Secure = no critical issues, At Risk = security concerns found, Critical = immediate attention needed"></i>
                        </h6>
                        <h4 id="security-status" class="mb-0">Secure</h4>
                    </div>
                    <div class="align-self-center">
                        <i class="bi bi-shield-check fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-info text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title d-flex align-items-center">
                            Devices Scanned 
                            <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                               data-bs-title="Number of network devices that have been security scanned in the selected time period. Regular scanning helps maintain network security."></i>
                        </h6>
                        <h4 id="devices-scanned" class="mb-0">--</h4>
                    </div>
                    <div class="align-self-center">
                        <i class="bi bi-router fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-warning text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title d-flex align-items-center">
                            Open Ports 
                            <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                               data-bs-title="Network ports that are accepting connections. Each open port represents a service that could be a potential entry point. Not all open ports are security risks."></i>
                        </h6>
                        <h4 id="total-open-ports" class="mb-0">--</h4>
                    </div>
                    <div class="align-self-center">
                        <i class="bi bi-door-open fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-danger text-white">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="card-title d-flex align-items-center">
                            High Risk Devices 
                            <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                               data-bs-title="Devices with security concerns that need attention. High risk typically means vulnerable services, suspicious ports, or outdated software detected."></i>
                        </h6>
                        <h4 id="high-risk-devices" class="mb-0">--</h4>
                    </div>
                    <div class="align-self-center">
                        <i class="bi bi-exclamation-triangle fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Security Charts -->
<div class="row mb-4">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header d-flex align-items-center justify-content-between">
                <h6 class="mb-0 d-flex align-items-center">
                    <i class="bi bi-bar-chart"></i> Security Alerts by Type
                    <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                       data-bs-title="Breakdown of security alerts by category: New Service (newly discovered services), Suspicious Port (risky open ports), Vulnerability (security weaknesses)"></i>
                </h6>
            </div>
            <div class="card-body">
                <canvas id="security-alerts-chart" style="height: 300px;"></canvas>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header d-flex align-items-center justify-content-between">
                <h6 class="mb-0 d-flex align-items-center">
                    <i class="bi bi-pie-chart"></i> Risk Distribution
                    <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                       data-bs-title="Distribution of security issues by severity: Critical (immediate action required), High (review soon), Medium (monitor), Low (informational)"></i>
                </h6>
            </div>
            <div class="card-body">
                <canvas id="risk-distribution-chart" style="height: 300px;"></canvas>
            </div>
        </div>
    </div>
</div>

<!-- Network Security Overview -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0 d-flex align-items-center">
                    <i class="bi bi-network-widescreen"></i> Network Security Overview
                    <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                       data-bs-title="Security status of all monitored devices including open ports, risk scores, and detected services. Use the scan button to check individual devices."></i>
                </h6>
                <div class="btn-group btn-group-sm">
                    <button class="btn btn-outline-secondary time-filter" data-hours="24">24h</button>
                    <button class="btn btn-outline-secondary time-filter" data-hours="168">7d</button>
                    <button class="btn btn-outline-secondary time-filter" data-hours="720">30d</button>
                </div>
            </div>
            <div class="card-body">
                <div id="network-overview-table">
                    <div class="placeholder-glow">
                        <div class="placeholder col-12 mb-2"></div>
                        <div class="placeholder col-10 mb-2"></div>
                        <div class="placeholder col-8 mb-2"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Security Alerts -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0 d-flex align-items-center">
                    <i class="bi bi-shield-exclamation"></i> Recent Security Alerts
                    <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                       data-bs-title="Security alerts generated by network scans. Review each alert to understand potential risks and take appropriate action. Acknowledging alerts marks them as reviewed."></i>
                </h6>
                <button class="btn btn-sm btn-outline-secondary" id="acknowledge-all-alerts"
                        data-bs-toggle="tooltip" data-bs-placement="left" 
                        data-bs-title="Mark all security alerts as acknowledged. Use this when you've reviewed all alerts and understand the risks.">
                    <i class="bi bi-check-all"></i> Acknowledge All
                </button>
            </div>
            <div class="card-body">
                <div id="security-alerts-table">
                    <div class="placeholder-glow">
                        <div class="placeholder col-12 mb-2"></div>
                        <div class="placeholder col-10 mb-2"></div>
                        <div class="placeholder col-8 mb-2"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Risk Assessment -->
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0 d-flex align-items-center">
                    <i class="bi bi-clipboard-data"></i> Security Recommendations
                    <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                       data-bs-title="AI-generated security recommendations based on your network's current state and detected issues. Follow these suggestions to improve your security posture."></i>
                </h6>
            </div>
            <div class="card-body">
                <div id="security-recommendations">
                    <div class="placeholder-glow">
                        <div class="placeholder col-12 mb-2"></div>
                        <div class="placeholder col-10 mb-2"></div>
                        <div class="placeholder col-8"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0 d-flex align-items-center">
                    <i class="bi bi-gear"></i> Security Settings
                    <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="top" 
                       data-bs-title="Configure security scan parameters. More frequent scans provide better monitoring but use more system resources. Higher port counts give more comprehensive results."></i>
                </h6>
            </div>
            <div class="card-body">
                <form id="security-settings-form">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <div class="mb-3">
                        <label class="form-label d-flex align-items-center">
                            Scan Interval (hours)
                            <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="right" 
                               data-bs-title="How often to automatically scan the network. 24 hours is recommended for most home networks. More frequent scanning uses more resources."></i>
                        </label>
                        <input type="number" class="form-control" id="scan-interval" min="1" max="168" value="24">
                    </div>
                    <div class="mb-3">
                        <label class="form-label d-flex align-items-center">
                            Top Ports to Scan
                            <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="right" 
                               data-bs-title="Number of most common ports to check. Top 1000 provides good coverage for most threats. Higher numbers take longer but are more thorough."></i>
                        </label>
                        <select class="form-select" id="top-ports">
                            <option value="100">Top 100 ports (fast)</option>
                            <option value="1000" selected>Top 1000 ports (recommended)</option>
                            <option value="10000">Top 10000 ports (comprehensive)</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="service-detection" checked>
                            <label class="form-check-label d-flex align-items-center" for="service-detection">
                                Service Detection
                                <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="right" 
                                   data-bs-title="Identify what services are running on open ports (e.g., web server, SSH). Provides more detailed security information but takes longer."></i>
                            </label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="version-detection" checked>
                            <label class="form-check-label d-flex align-items-center" for="version-detection">
                                Version Detection
                                <i class="bi bi-info-circle ms-2" data-bs-toggle="tooltip" data-bs-placement="right" 
                                   data-bs-title="Detect software versions of running services. Helps identify outdated software with known vulnerabilities. Recommended for security monitoring."></i>
                            </label>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-check-circle"></i> Update Settings
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/security-page.js') }}"></script>
{% endblock %}